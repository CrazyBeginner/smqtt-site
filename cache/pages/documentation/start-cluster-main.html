<h2 id="_1">引入依赖</h2>
<pre class="code literal-block">    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>io.github.quickmsg<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>smqtt-core<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>1.0.6<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>io.github.quickmsg<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>smqtt-registry-scube<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>1.0.6<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
</pre>
<h2 id="_2">示例如下:</h2>
<ol>
<li>cluster-node1</li>
</ol>
<pre class="code literal-block"><span class="n">Bootstrap</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="n">Bootstrap</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="p">.</span><span class="na">port</span><span class="p">(</span><span class="mi">8555</span><span class="p">)</span>
<span class="p">.</span><span class="na">websocketPort</span><span class="p">(</span><span class="mi">8999</span><span class="p">)</span>
<span class="p">.</span><span class="na">options</span><span class="p">(</span><span class="n">channelOptionMap</span> <span class="o">-&gt;</span> <span class="p">{})</span><span class="c1">//netty options设置</span>
<span class="p">.</span><span class="na">childOptions</span><span class="p">(</span><span class="n">channelOptionMap</span> <span class="o">-&gt;</span><span class="p">{})</span> <span class="c1">//netty childOptions设置</span>
<span class="p">.</span><span class="na">highWaterMark</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span>
<span class="p">.</span><span class="na">lowWaterMark</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="p">.</span><span class="na">ssl</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="p">.</span><span class="na">sslContext</span><span class="p">(</span><span class="k">new</span> <span class="n">SslContext</span><span class="p">(</span><span class="s">&quot;crt&quot;</span><span class="p">,</span><span class="s">&quot;key&quot;</span><span class="p">))</span>
<span class="p">.</span><span class="na">isWebsocket</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="p">.</span><span class="na">wiretap</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="p">.</span><span class="na">httpOptions</span><span class="p">(</span><span class="n">Bootstrap</span><span class="p">.</span><span class="na">HttpOptions</span><span class="p">.</span><span class="na">builder</span><span class="p">().</span><span class="na">ssl</span><span class="p">(</span><span class="kc">false</span><span class="p">).</span><span class="na">httpPort</span><span class="p">(</span><span class="mi">62212</span><span class="p">).</span><span class="na">accessLog</span><span class="p">(</span><span class="kc">true</span><span class="p">).</span><span class="na">build</span><span class="p">())</span>
<span class="p">.</span><span class="na">clusterConfig</span><span class="p">(</span>
        <span class="n">ClusterConfig</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
                <span class="p">.</span><span class="na">clustered</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
                <span class="p">.</span><span class="na">port</span><span class="p">(</span><span class="mi">7773</span><span class="p">)</span>
                <span class="p">.</span><span class="na">nodeName</span><span class="p">(</span><span class="s">&quot;node-2&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="na">clusterUrl</span><span class="p">(</span><span class="s">&quot;127.0.0.1:7771,127.0.0.1:7772&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="na">build</span><span class="p">())</span>
<span class="p">.</span><span class="na">build</span><span class="p">()</span>
<span class="p">.</span><span class="na">start</span><span class="p">().</span><span class="na">block</span><span class="p">();</span>
</pre>
<ol>
<li>cluster-node2</li>
</ol>
<pre class="code literal-block"><span class="n">Bootstrap</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="n">Bootstrap</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
              <span class="p">.</span><span class="na">port</span><span class="p">(</span><span class="mi">8556</span><span class="p">)</span>
              <span class="p">.</span><span class="na">options</span><span class="p">(</span><span class="n">channelOptionMap</span> <span class="o">-&gt;</span> <span class="p">{})</span><span class="c1">//netty options设置</span>
              <span class="p">.</span><span class="na">childOptions</span><span class="p">(</span><span class="n">channelOptionMap</span> <span class="o">-&gt;</span><span class="p">{})</span> <span class="c1">//netty childOptions设置</span>
              <span class="p">.</span><span class="na">highWaterMark</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span>
              <span class="p">.</span><span class="na">lowWaterMark</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
              <span class="p">.</span><span class="na">ssl</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
              <span class="p">.</span><span class="na">wiretap</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
              <span class="p">.</span><span class="na">clusterConfig</span><span class="p">(</span>
                      <span class="n">ClusterConfig</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
                      <span class="p">.</span><span class="na">clustered</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
                              <span class="p">.</span><span class="na">port</span><span class="p">(</span><span class="mi">7772</span><span class="p">)</span>
                              <span class="p">.</span><span class="na">nodeName</span><span class="p">(</span><span class="s">&quot;node-3&quot;</span><span class="p">)</span>
                              <span class="p">.</span><span class="na">clusterUrl</span><span class="p">(</span><span class="s">&quot;127.0.0.1:7771,127.0.0.1:7773&quot;</span><span class="p">)</span>
                              <span class="p">.</span><span class="na">build</span><span class="p">())</span>
              <span class="p">.</span><span class="na">build</span><span class="p">()</span>
              <span class="p">.</span><span class="na">start</span><span class="p">().</span><span class="na">block</span><span class="p">();</span>
</pre>
<ol>
<li>cluster-node3</li>
</ol>
<pre class="code literal-block">  <span class="n">Bootstrap</span> <span class="n">bootstrap</span> <span class="o">=</span> <span class="n">Bootstrap</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
                <span class="p">.</span><span class="na">port</span><span class="p">(</span><span class="mi">8551</span><span class="p">)</span>
                <span class="p">.</span><span class="na">options</span><span class="p">(</span><span class="n">channelOptionMap</span> <span class="o">-&gt;</span> <span class="p">{})</span><span class="c1">//netty options设置</span>
                <span class="p">.</span><span class="na">childOptions</span><span class="p">(</span><span class="n">channelOptionMap</span> <span class="o">-&gt;</span><span class="p">{})</span> <span class="c1">//netty childOptions设置</span>
                <span class="p">.</span><span class="na">highWaterMark</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span>
                <span class="p">.</span><span class="na">lowWaterMark</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
                <span class="p">.</span><span class="na">ssl</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
                <span class="p">.</span><span class="na">wiretap</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
                <span class="p">.</span><span class="na">clusterConfig</span><span class="p">(</span>
                        <span class="n">ClusterConfig</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
                        <span class="p">.</span><span class="na">clustered</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
                                <span class="p">.</span><span class="na">port</span><span class="p">(</span><span class="mi">7771</span><span class="p">)</span>
                                <span class="p">.</span><span class="na">nodeName</span><span class="p">(</span><span class="s">&quot;node-4&quot;</span><span class="p">)</span>
                                <span class="p">.</span><span class="na">clusterUrl</span><span class="p">(</span><span class="s">&quot;127.0.0.1:7772,127.0.0.1:7773&quot;</span><span class="p">)</span>
                                <span class="p">.</span><span class="na">build</span><span class="p">())</span>
                <span class="p">.</span><span class="na">build</span><span class="p">()</span>
                <span class="p">.</span><span class="na">start</span><span class="p">().</span><span class="na">block</span><span class="p">();</span>
</pre>
<h2 id="_3">启动参数详解</h2>
<p>ClusterConfig参数：</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>必传</th>
</tr>
</thead>
<tbody>
<tr>
<td>clustered</td>
<td>开启集群</td>
<td>是</td>
</tr>
<tr>
<td>port</td>
<td>集群通信端口</td>
<td>是</td>
</tr>
<tr>
<td>nodeName</td>
<td>节点名称唯一</td>
<td>是</td>
</tr>
<tr>
<td>clusterUrl</td>
<td>集群节点url</td>
<td>是</td>
</tr>
</tbody>
</table>