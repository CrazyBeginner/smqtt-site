<h2 id="interceptor">Interceptor接口详解</h2>
<ul>
<li>io.github.quickmsg.common.interceptor.Interceptor</li>
</ul>
<table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
<th>必传</th>
</tr>
</thead>
<tbody>
<tr>
<td>Object doInterceptor(Invocation invocation)</td>
<td>拦截方法</td>
<td>是</td>
</tr>
<tr>
<td>int order()</td>
<td>拦截排序</td>
<td>是</td>
</tr>
</tbody>
</table>
<ul>
<li>Invocation  属性说明</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>必传</th>
</tr>
</thead>
<tbody>
<tr>
<td>method</td>
<td>请求的 MqttChannel</td>
<td>是</td>
</tr>
<tr>
<td>target</td>
<td>请求的 MqttMessage</td>
<td>是</td>
</tr>
<tr>
<td>args</td>
<td>请求的ReceiveContext</td>
<td>是</td>
</tr>
</tbody>
</table>
<ul>
<li>方法</li>
</ul>
<table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>public Object proceed()</td>
<td>放行拦截器</td>
</tr>
</tbody>
</table>
<h2 id="_1">自定义拦截器</h2>
<ul>
<li>实现接口</li>
</ul>
<pre class="code literal-block"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DemoInterceptor</span> <span class="kd">implements</span> <span class="n">Interceptor</span> <span class="p">{</span>


    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">intercept</span><span class="p">(</span><span class="n">Invocation</span> <span class="n">invocation</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="n">Method</span> <span class="n">method</span> <span class="o">=</span> <span class="n">invocation</span><span class="p">.</span><span class="na">getMethod</span><span class="p">();</span>
            <span class="n">Object</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="n">invocation</span><span class="p">.</span><span class="na">getArgs</span><span class="p">();</span>
            <span class="n">Object</span> <span class="n">target</span> <span class="o">=</span> <span class="n">invocation</span><span class="p">.</span><span class="na">getTarget</span><span class="p">();</span>
<span class="c1">//            MqttChannel mqttChannel, MqttMessage mqttMessage, ReceiveContext&lt;C&gt; receiveContext</span>

            <span class="n">MqttChannel</span> <span class="n">mqttChannel</span> <span class="o">=</span> <span class="p">(</span><span class="n">MqttChannel</span><span class="p">)</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span> <span class="c1">// channel</span>
            <span class="n">MqttMessage</span> <span class="n">mqttMessage</span> <span class="o">=</span> <span class="p">(</span><span class="n">MqttMessage</span><span class="p">)</span> <span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">;</span> <span class="c1">// MqttMessage</span>
            <span class="n">ReceiveContext</span> <span class="n">receiveContext</span> <span class="o">=</span> <span class="p">(</span><span class="n">ReceiveContext</span><span class="p">)</span> <span class="n">args</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">;</span> <span class="c1">// ReceiveContext</span>

            <span class="c1">// 拦截业务</span>

            <span class="k">return</span> <span class="n">invocation</span><span class="p">.</span><span class="na">proceed</span><span class="p">();</span> <span class="c1">// 放行</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InvocationTargetException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IllegalAccessException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">sort</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre>
<ul>
<li>SPI注入</li>
</ul>
<p><code>具体参考java SPI注入</code></p>
<p>resources/WEB-INF/services 目录下新建
名为io.github.quickmsg.common.interceptor.Interceptor文件,
将自定义实现类全限定名写入文件中即可完成注入。</p>